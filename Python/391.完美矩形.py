#
# @lc app=leetcode.cn id=391 lang=python3
#
# [391] 完美矩形
#

# @lc code=start
class Solution(object):
    def isRectangleCover(self, rectangles):
        """
        :type rectangles: List[List[int]]
        :rtype: bool
        """
        # [[1,1,3,3],[3,1,4,2],[3,2,4,4],[1,3,2,4],[2,3,3,4]]
        rows = dict()
        for min_x, min_y, max_x, max_y in sorted(rectangles,key=lambda item:item[0]):
            for cur_y in range(min_y, max_y):
                if cur_y in rows:
                    if min_x - rows[cur_y][1] != 0:
                        return False
                    else:
                        rows[cur_y][1] = max_x
                else:
                    rows[cur_y] = [min_x, max_x]
        keys = sorted(rows.keys())
        last_key = keys[0]
        same_value  = rows[last_key]
        for key in keys[1:]:
            if rows[key] != same_value:
                return False
            if key - last_key != 1:
                return False
            last_key = key
        return True
# @lc code=end

if __name__ == "__main__":
    # rectangles = [[1,1,3,3],[3,1,4,2],[3,2,4,4],[1,3,2,4],[2,3,3,4]]
    rectangles = [[1,1,3,3],[3,1,4,2],[3,2,4,4],[1,3,2,4],[2,3,3,4]]
    #rectangles = [[0,0,1,1],[0,1,3,2],[1,0,2,2]]
    # rectangles = [[-9573,13095,-7899,14471],[-12809,12998,-12160,14710],[4393,-19141,4881,-18539],[13398,17732,14668,20666],[-7786,-1346,-5208,-1090],[17684,17536,19299,18654],[-12160,-718,-10867,640],[-5354,-3895,-5208,-1346],[14100,-19878,16099,-19142],[-7538,11785,-5354,12998],[13108,-14568,14668,-11264],[19299,17536,19584,19886],[6403,2113,7328,3953],[-7538,-18539,-5208,-16655],[15348,9733,18000,10728],[-9828,4548,-9161,4785],[-18464,-4715,-16393,-3649],[-17318,8466,-16326,10359],[-13424,6233,-12748,7825],[569,-2909,3505,-1090],[-2015,-5235,-594,-3895],[-9161,-17630,-7786,-15085],[14100,-16734,15348,-16501],[-16326,-5000,-14784,-3895],[13398,13095,15689,15784],[3505,4771,4881,6122],[-16326,15308,-14835,16478],[-10309,11103,-9840,12755],[19084,9733,19992,10728],[-9890,5618,-9803,6634],[-2015,8466,-494,10212],[16099,-6552,19084,-4197],[-12130,-17980,-10309,-16147],[13398,1384,15241,3970],[-4918,-19515,-3933,-19431],[-18809,-14568,-17318,-11595],[-594,-8111,518,-5235],[-5144,-13457,-3707,-9406],[5183,-14389,5757,-13365],[518,-16655,3621,-15085],[-19421,8466,-17442,10359],[1603,-6552,1972,-4715],[15689,2113,19009,3970],[-13921,11137,-12809,11785],[-19523,3970,-18486,5618],[-9803,7721,-9573,10359],[-5144,-9194,-4485,-6569],[-16900,20150,-14992,20990],[17021,3970,19159,4771],[-5354,13271,-4918,15061],[15689,7038,15884,7061],[15241,2535,15689,4263],[9781,4263,11901,5618],[15689,11137,17021,14471],[13398,214,14120,1118],[2714,-9404,4881,-6714],[-11919,17169,-10309,19870],[-2139,-18767,-1445,-18539],[-17442,17732,-16326,19808],[1972,-4197,4819,-3052],[-6999,-19431,-5144,-19142],[-18015,4263,-16900,5618],[300,253,3832,803],[-19623,16478,-18464,18166],[4819,-6569,5266,-5235],[4819,18654,5757,20150],[-19421,-11138,-17318,-7636],[-17182,-8111,-15236,-6552],[15348,-13413,18000,-11138],[-19527,-17791,-18795,-17630],[-19523,6233,-18486,7199],[-13095,-19709,-12748,-19431],[7468,3283,8139,4771],[-1445,-18539,1080,-17630],[7081,-18767,7468,-18539],[-19800,-1346,-18809,-1044],[7328,-7020,10246,-5000],[-2015,4793,-145,7038],[-3883,10212,-2802,11137],[19084,-4004,19992,-2767],[-17318,10865,-16326,13095],[-14784,16862,-13417,19112],[-13095,12140,-12809,13595],[-2139,18654,-494,20990],[19009,9585,19084,10400],[-5354,10728,-4681,12140],[-3883,13095,-3707,14710],[-9828,-4004,-7899,-1977],[-7899,-18801,-7538,-17791],[15884,-18539,18000,-16734],[-13921,8466,-13417,9585],[-494,9733,569,10359],[-5069,1384,-3883,1771],[8968,-5000,11022,-3649],[9781,-14828,11901,-13457],[-12160,-16147,-10193,-14389],[6728,16423,8935,17536],[5266,4164,7328,5618],[-1733,-13365,518,-9654],[-14470,10369,-12748,10865],[-5208,-19878,-4485,-19515],[-12160,10369,-11919,11103],[-2796,-6714,-1696,-6552],[-13417,-13413,-12089,-11138],[2714,-1090,4819,-390],[5757,-17980,7029,-16734],[-14835,16423,-14784,18439],[-3065,-14279,-2015,-11264],[-19527,2113,-18015,3262],[15884,-16147,19084,-14568],[-17318,13095,-17180,14710],[14213,10728,16099,11137],[13398,3970,14804,4771],[-3933,12755,-2802,12998],[-9840,-16655,-9161,-16113],[-3707,7825,-2015,9733],[-12951,803,-11919,1494],[-13095,4785,-12809,6233],[-18809,-19878,-18464,-19142],[-19800,15784,-18795,16478],[-17182,1665,-16900,2535],[19084,-14568,19584,-11595],[-10921,-14279,-10193,-13365],[-11610,3970,-10309,4548],[-5069,-1977,-3758,253],[-1733,7038,300,7721],[-19523,-4715,-18464,-3649],[-9573,15013,-5354,16423],[-3933,-16113,-3065,-14704],[-5208,-3895,-4485,-1977],[-19523,-718,-17442,253],[-9161,-1044,-5208,529],[6403,-8859,6801,-5468],[6403,18439,7468,19870],[-11610,19886,-9828,20990],[-145,10359,1603,12140],[-2015,2535,-1445,4164],[2714,18166,4819,19870],[10246,15683,11012,17732],[-10309,-5468,-9890,-4197],[-1781,253,-1609,1494],[-3883,-19539,-3217,-18801],[14668,19886,15348,20666],[-13417,-4004,-12130,-2909],[14804,19112,16099,19886],[7601,-13457,8968,-11138],[13108,-11264,14804,-8859],[-18015,-3052,-16326,-1090],[-14784,13271,-13417,14710],[-15236,-2909,-13424,-718],[4881,1494,5757,1771],[-11610,11137,-10309,14471],[-9448,-18801,-9161,-17630],[11901,-19623,13398,-19515],[-6145,7199,-4681,9729],[15884,16862,17684,18166],[-16326,8909,-14835,9729],[-14535,-11595,-13417,-9654],[6403,17536,8139,17732],[14213,-6569,15241,-6552],[-15428,13271,-15236,15308],[5330,14471,7081,15683],[2714,-5462,4819,-4197],[-15861,-11730,-14535,-9654],[-14535,-654,-12951,640],[14100,-16113,14213,-14568],[14213,4771,16316,5977],[-17442,529,-14992,1384],[-15236,13271,-14835,15061],[-14835,-13457,-13417,-11730],[-9573,-1346,-9161,-390],[4881,-9406,5757,-6714],[-2802,6634,-2015,7825],[5183,-1977,7328,214],[18082,-18767,19992,-16734],[7328,214,10303,529],[-15428,-18801,-13921,-17679],[4393,803,5183,1494],[-2015,-654,-1696,214],[518,9585,569,9733],[8139,1494,8968,3858],[10303,11785,13108,13595],[-1781,-16501,-594,-14568],[-3758,-9194,-3065,-6552],[-1445,-19878,518,-19623],[4969,-16501,6801,-14568],[-1781,-3895,-594,-2767],[-5208,-17630,-3758,-16501],[-10867,253,-9840,1384],[300,13271,3007,15061],[14668,7721,15689,9005],[5330,12998,7468,13595],[5757,11137,7081,12755],[11022,7721,13108,9005],[10246,-7020,10646,-5235],[-12951,3283,-12130,3953],[17684,-1346,19992,640],[6403,-9654,7328,-8859],[1603,-1090,2714,214],[-9890,10853,-9448,11103],[15884,-4004,16316,-3052],[8968,10369,10646,11785],[518,-13365,1603,-8859],[-2015,-19539,-145,-19141],[-13424,-4004,-13417,-2767],[12689,4771,13398,6122],[11526,-13365,12654,-11138],[6728,1384,7468,1494],[1080,-19515,3621,-18801],[8035,12140,10303,13095],[16517,-9469,19299,-9406],[-9840,-9469,-9161,-7636],[15241,-16501,15884,-15085],[-19523,9005,-19421,9733],[6728,13595,7601,14471],[-3707,15013,-2015,15308],[3007,1494,4881,1665],[-7899,13095,-6145,13271],[4881,16478,6403,18166],[-12748,-19141,-11610,-17980],[-13417,-19431,-12951,-18801],[-19800,4785,-19623,4793],[-19800,10853,-19421,13095],[-4681,-14389,-3065,-14279],[-9840,-4715,-9803,-4004],[-13921,-16655,-12748,-14568],[15884,14471,16316,15061],[17684,7721,19299,9585],[7468,18439,9781,19112],[-4485,-19431,-3933,-17679],[-19527,3283,-18809,3970],[3007,1665,3505,3858],[11526,-18801,12654,-16655],[17021,-8111,19299,-7636],[10246,3262,11901,3970],[-19623,-16734,-19523,-15085],[6728,3953,7328,4164],[1080,-6714,2714,-6569],[-12130,9585,-9890,10039],[4881,15683,7029,16423],[-12960,-9654,-11919,-7020],[-14835,-19515,-13417,-18801],[18082,11103,19992,12998],[5757,1494,7328,2113],[18000,640,19159,2113],[11022,6122,12654,7721],[-3217,-11264,-1781,-9469],[-9828,14471,-6927,15013],[-1696,-7636,-1445,-5235],[5266,18166,6801,18439],[518,19112,1972,20666],[-17318,-11264,-16900,-8859],[15241,1118,15884,1771],[-5069,-16501,-3933,-14828],[-3883,9005,-3707,9733],[7468,15061,8035,15784],[-3596,-6552,-1781,-5299],[-2802,11785,-2344,13271],[7468,9585,8139,10359],[-14835,-8859,-13424,-6552],[-14835,3953,-14470,4548],[-5208,2535,-4485,4164],[15884,-9406,19009,-8111],[-11919,6634,-10309,9005],[6403,-5235,7081,-4715],[7328,19886,8139,20990],[13830,5977,14100,7038],[12654,7038,13398,7721],[1603,9585,3621,10369],[18082,-19878,19584,-19623],[-17318,14710,-16326,15308],[-10193,18166,-9828,18654],[-3707,16423,-2139,19112],[11012,-2909,12689,-1977],[5330,7825,6801,10212],[7081,10369,7468,11785],[-12960,11785,-12160,12140],[16517,18654,18000,19886],[6728,5977,7468,7061],[-14470,-19878,-12809,-19709],[-3217,19343,-2344,20990],[6403,-14568,7328,-14389],[-7899,5977,-6145,7721],[17684,13095,19159,14710],[14213,-15085,15689,-14704],[-15236,-14568,-13921,-14279],[-7786,-8111,-5354,-5468],[-19421,10369,-18739,11103],[14213,-17791,15884,-16734],[-13095,-17679,-12951,-17630],[19299,10728,19584,11103],[3832,-2909,5266,-1977],[300,-3101,569,-1346],[14120,-2909,15884,-718],[6801,-3101,7029,-2909],[-14784,803,-13095,1665],[300,19808,518,20990],[-1609,16862,-594,18439],[-10193,-19431,-9448,-17791],[-13095,1118,-12960,1384],[-9840,1665,-9828,3283],[-1445,253,300,1118],[-19800,-11138,-19623,-7020],[5266,-2909,7328,-1977],[-10193,4771,-9890,5977],[-2139,12755,-1696,13595],[-18809,3858,-18015,3970],[-19800,8909,-19623,9733],[10646,10039,11526,10853],[-9448,18654,-5208,19886],[-1696,1494,-494,2535],[-7786,-4197,-5354,-2909],[-18486,5977,-17182,7061],[518,1258,3007,1665],[-3883,-16501,-3596,-16147],[-1781,-8111,-594,-7636],[7081,-5000,7468,-4197],[3621,10039,4881,10865],[-494,-1044,1080,-390],[4969,6233,6728,7721],[-14784,-6552,-13095,-5000],[12654,-19142,14100,-16734],[-2796,3858,-2139,4164],[18000,9585,19009,10212],[10646,-5299,12654,-5000],[-7786,-11730,-6999,-11595],[15689,-19142,18000,-18767],[-19421,11103,-18464,13095],[-19800,-3052,-19523,-1944],[-16900,-19141,-16326,-17679],[569,-3052,3007,-2909],[10303,-19623,11022,-19141],[-13921,2113,-13057,3283],[-17180,-14828,-15236,-14389],[-4485,11103,-3933,12140],[1603,-14704,3621,-11730],[10246,-1944,11526,-1090],[14120,-19141,15348,-17980],[-13424,15308,-13057,16862],[-3707,-4197,-3596,-2767],[13830,-5000,14804,-4197],[-17442,7061,-15861,8466],[5183,-3052,6801,-2909],[6728,-19709,7601,-19431],[-19800,19808,-19527,20990],[-4918,803,-3758,1258],[5266,214,7029,529],[-15236,-654,-14535,529],[-2796,9733,-2139,11103],[-12951,-17630,-12130,-16655],[-9573,-19623,-7538,-19431],[8935,15061,9781,16478],[-14535,-11730,-13921,-11595],[4881,-18539,5757,-16734],[18000,15061,19992,16478],[1972,3858,3832,4548],[17021,4771,18082,5977],[-11919,640,-10921,2535],[-12809,4793,-11919,6122],[-2802,10359,-2796,11103],[7601,640,8968,1494],[-1696,13271,-1445,14471],[-19523,14471,-17318,15683],[-10309,-16734,-9840,-16147],[-3596,-5299,-3065,-4004],[2714,-19878,3505,-19515],[-5208,640,-4918,1384],[-3065,-8111,-2015,-6714],[11526,16862,13108,17732],[-10867,-1044,-9840,-654],[13398,-654,14100,214],[-15236,16862,-14992,18166],[-1781,-14389,-494,-13365],[-18015,3262,-16326,4164],[-11610,2535,-10193,3970],[300,4263,1972,6122],[-3596,6233,-2802,7825],[-18809,-5462,-18795,-4871],[4969,12755,7081,12998],[3832,-1346,4969,-1090],[-13057,3262,-12130,3283],[-13057,15308,-12809,17536],[7328,1494,7468,3858],[-17180,-17679,-14992,-14828],[2714,-18539,4393,-17630],[11526,16423,11901,16862],[-12089,-3895,-10921,-1346]]

    print(Solution().isRectangleCover(rectangles))
